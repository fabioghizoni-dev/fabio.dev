---
import { Icon } from "astro-icon/components";
import cn from "../utils/cn";

interface Props {
  id?: string;
  href?: string;
  icon?: string;
  title?: string;
  class?: string;
  underlineColor?: string;
  underlineHeight?: string;
  variant?: "default" | "primary";
  type?: astroHTML.JSX.AnchorHTMLAttributes["type"];
  role?:
    | astroHTML.JSX.AnchorHTMLAttributes["role"]
    | astroHTML.JSX.LiHTMLAttributes["role"];
}

const {
  href,
  icon,
  role = "link",
  type = "link",
  id = "li-home",
  class: className,
  variant = "default",
  title = "Go to home",
  underlineHeight = "0.5",
  underlineColor = "purple-blue",
} = Astro.props as Props;

const underlineSide = (side: "before" | "after", width = "1/2") => {
  let position = side === "before" ? "right-0" : "left-0";
  return `${side}:absolute ${side}:w-0 ${side}:h-${underlineHeight} ${side}:content-[''] ${side}:${position} ${side}:bottom-0
  ${side}:bg-${underlineColor} hover:${side}:w-${width} ${side}:transition-all ${side}:duration-300 ${side}:ease-in-out`;
};

const isPrimary = variant === "primary" ? underlineSide("after", "full") : "";
const isDefault =
  variant === "default"
    ? `${underlineSide("before")} ${underlineSide("after")}`
    : "";

const Tag = href ? "a" : "li";
const baseClass =
  "relative text-nowrap cursor-pointer text-xs sm:text-sm md:text-base lg:text-xl xl:text-xl 2xl:text-xl";
const finalClass = cn(`${baseClass} ${isDefault || isPrimary} ${className}`);
---

<Tag
  href={href}
  role={role}
  type={type}
  id={id}
  data-variant={variant}
  title={title}
  class={finalClass}
>
  <slot />
  {icon && <Icon name={icon} class="block sm:hidden size-8" />}
</Tag>
