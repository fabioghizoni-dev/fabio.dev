---
import Analytics from "@vercel/analytics/astro";
import SpeedInsights from "@vercel/speed-insights/astro";
import { ClientRouter } from "astro:transitions";
import CopyRight from "../components/CopyRight.astro";
import Header from "../components/Header.astro";
import "../styles/globals.css";
import Modal from "../ui/Modal.astro";
import cn, { removeSpaces } from "../utils";

interface Props {
  lang?: string;
  title?: string;
  author?: string;
  header?: boolean;
  footer?: boolean;
  siteUrl?: string;
  iconHref?: string;
  dataTheme?: string;
  generator?: string;
  bodyClass?: string;
  keywords?: string[];
  description?: string;
  clientRouter?: boolean;
}

const {
  header,
  footer,
  lang = "en",
  bodyClass = "",
  dataTheme = "dark",
  clientRouter = true,
  iconHref = "/logo.svg",
  author = "F치bio Ghizoni",
  generator = Astro.generator,
  title = "Portf칩lio | F치bio Ghizoni",
  siteUrl = "https://portfolio-fabio-main.vercel.app",
  description = removeSpaces(`Welcome to my portfolio website. Feel free to explore and learn more about the site and me. 
    Here you'll find my projects and information about my skills and experiences.`),
  keywords = [
    "Astro",
    "React",
    "Node.js",
    "Database",
    "Back-end",
    "Front-end",
    "Portfolio",
    "Developer",
    "TypeScript",
    "JavaScript",
    "UI/UX Design",
    "Tailwind CSS",
    "Web Developer",
    "F치bio Ghizoni",
    "Paran치 Brazil",
    "Tech Portfolio",
    "Web Development",
    "API development",
    "Software Engineer",
    "Desenvolvedor Web",
    "Responsive Design",
    "Full-stack Developer",
    "Programador Full-stack",
    "Web Application Development",
  ],
} = Astro.props as Props;

const baseBodyClass = `flex flex-col justify-between items-center w-full min-h-screen bg-white/80 dark:bg-black 
  dark:selection:bg-white dark:selection:text-purple-blue selection:bg-purple-blue selection:text-white
  transition-colors ease-in-out duration-500`;
---

<!doctype html>
<html lang={lang} data-theme={dataTheme}>
  <head>
    {clientRouter && <ClientRouter />}

    <meta charset="UTF-8" />
    <meta name="language" content={lang} />
    <meta name="author" content={author} />
    <meta name="generator" content={generator} />
    <meta name="description" content={description} />
    <link rel="canonical" href={siteUrl} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content={dataTheme === "dark" ? "#000" : "#fff"} />
    <meta name="keywords" content={keywords.join(", ")} />

    <!-- Title -->
    <title>{title}</title>

    <!-- Icon -->
    <link rel="icon" type="image/svg+xml" href={iconHref} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:site_name" content="Portf칩lio | F치bio Ghizoni" />
    <meta property="og:url" content={siteUrl} />
    <meta property="og:image" content={`${siteUrl}/logo_neon.svg`} />

    <!-- Twitter Card -->
    <meta name="twitter:title" content={title} />
    <meta name="twitter:creator" content="@FGhizoni28539" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content={`${siteUrl}/logo_neon.svg`} />
    <meta name="twitter:description" content={description} />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link crossorigin rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Cascadia+Code:ital,wght@0,200..700;1,200..700&family=Noto+Sans+JP:wght@100..900&family=Space+Grotesk:wght@300..700&display=swap"
    />
  </head>
  <body class={cn(baseBodyClass, bodyClass)}>
    <Analytics />
    <SpeedInsights />

    {header && <Header />}
    <Modal />
    <slot />
    {footer && <CopyRight />}

    <script>
      import c from "clogs.ts";

      addEventListener("DOMContentLoaded", () => {
        try {
          const savedLang = localStorage.getItem("site:lang") || "en";
          document.documentElement.lang = savedLang;
          c.log(`游깷 Language initialized: ${savedLang}`);
        } catch (err) {
          c.warn("Error initializing language:", err);
        }
      });
    </script>
  </body>
</html>
