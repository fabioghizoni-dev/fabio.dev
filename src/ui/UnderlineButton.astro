---
import cn from "../utils";

interface Props extends astroHTML.JSX.ButtonHTMLAttributes {
  id?: string;
  href?: string;
  title?: string;
  class?: string;
  active?: boolean;
  variant?: "default" | "primary";
  type?: astroHTML.JSX.ButtonHTMLAttributes["type"];
  role?: astroHTML.JSX.ButtonHTMLAttributes["role"];
}

const {
  href,
  active = false,
  id = "li-home",
  role = "button",
  type = "button",
  variant = "default",
  title = "Go to home",
  class: className = "",
  ...props
} = Astro.props as Props;

const isDefault = variant === "default";
const isPrimary = variant === "primary";

const stateClasses = {
  before: `before:bg-purple-blue hover:before:w-1/2 before:absolute before:w-0 before:h-0.8 before:content-[''] 
    before:left-0 before:bottom-0 before:rounded-l-sm before:transition-all before:duration-300 before:ease-in-out`,
  after: `after:bg-purple-blue hover:after:w-1/2 after:absolute after:w-0 after:h-0.8 after:content-[''] 
    after:left-0 after:bottom-0 after:rounded-r-sm after:transition-all after:duration-300 after:ease-in-out`,
};

const customClasses = {
  afterWidthFull: stateClasses.after.replace(
    "hover:after:w-1/2",
    "hover:after:w-full",
  ),
  afterSideRight: stateClasses.after.replace("after:left-0", "after:right-0"),
};

const defaultClass = isDefault
  ? `${stateClasses.before} ${customClasses.afterSideRight}`
  : "";

const classes = isPrimary ? customClasses.afterWidthFull : defaultClass;

const baseClass = "relative text-nowrap cursor-pointer text-xl";
const finalClass = cn(`${baseClass} ${classes} ${className}`);

const Tag = href ? "a" : "button";
---

<Tag
  role={role}
  type={type}
  id={id}
  href={href}
  data-variant={variant}
  title={title}
  class={finalClass}
  {...props}
>
  <slot />
</Tag>
