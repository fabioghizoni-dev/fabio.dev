---
import { Icon } from "astro-icon/components";
---

<button
  type="button"
  role="button"
  id="btn-theme"
  aria-label="BotÃ£o para trocar tema"
  class="relative flex w-12 h-12 ml-auto justify-center items-center overflow-hidden"
>
  <!-- Mode Dark -->
  <Icon
    id="btn-moon"
    title="Modo dark"
    aria-label="Modo dark"
    name="line-md:sunny-filled-loop-to-moon-filled-alt-loop-transition"
    class="absolute w-12 h-12 text-purple-blue cursor-pointer rounded-full"
  />
  <!-- Mode Light -->
  <Icon
    id="btn-sun"
    title="Modo light"
    aria-label="Modo light"
    name="line-md:moon-filled-alt-to-sunny-filled-loop-transition"
    class="absolute w-12 h-12 text-purple-blue cursor-pointer hidden rounded-full"
  />
</button>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const btnSun = document.getElementById("btn-sun");
    const btnMoon = document.getElementById("btn-moon");
    const btnTheme = document.getElementById("btn-theme");
    if (btnSun && btnMoon) {
      let isDark = true;
      const hide = (el) => {
        el.classList.add("animate-hide");
        el.addEventListener(
          "animationend",
          () => {
            el.classList.remove("animate-hide");
            el.classList.add("hidden");
          },
          { once: true }
        );
      };
      const show = (el) => {
        el.classList.remove("hidden");
        el.classList.add("animate-show");
        el.addEventListener(
          "animationend",
          () => {
            el.classList.remove("animate-show");
          },
          { once: true }
        );
      };
      const toggle = () => {
        isDark = !isDark;
        if (isDark) {
          hide(btnSun);
          show(btnMoon);
        } else {
          show(btnSun);
          hide(btnMoon);
        }
      };
      btnTheme.addEventListener("click", toggle);
    }
  });
</script>
